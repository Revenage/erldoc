{"summary":"Generic Functions for Implementing SNMP Objects in a Database","description":"<p> <a name=\"description\"></a> </p><p>The module <span class=\"code\">snmp_generic</span> contains generic functions for implementing tables (and variables) using the SNMP built-in database or Mnesia. These default functions are used if no instrumentation function is provided for a managed object in a MIB. Sometimes, it might be necessary to customize the behaviour of the default functions. For example, in some situations a trap should be sent if a row is deleted or modified, or some hardware is to be informed, when information is changed. </p> <p>The overall structure is shown in the following figure:</p> <div class=\"example\"><pre> +---------------+ | SNMP Agent | +- - - - - - - -+ | MIB | +---------------+ | Association file (associates a MIB object with | snmp_generic:table_funct | snmp_generic:variable_func)+--------------------------------------+| snmp_generic | Support for get-next,| | RowStatus operations+----------------------+---------------+| snmpa_local_db | Mnesia | Database+--------------+-------+---------------+| dets | ets | | (persistent) | | +--------------+-------+ </pre></div> <p>Each function takes the argument <span class=\"code\">NameDb</span>, which is a tuple <span class=\"code\">{Name, Db}</span>, to identify which database the functions should use. <span class=\"code\">Name</span> is the symbolic name of the managed object as defined in the MIB, and <span class=\"code\">Db</span> is either <span class=\"code\">volatile</span>, <span class=\"code\">persistent</span>, or <span class=\"code\">mnesia</span>. If it is <span class=\"code\">mnesia</span>, all variables are stored in the Mnesia table <span class=\"code\">snmp_variables</span> which must be a table with two attributes (not a Mnesia SNMP table). The SNMP tables are stored in Mnesia tables with the same names as the SNMP tables. All functions assume that a Mnesia table exists with the correct name and attributes. It is the programmer&apos;s responsibility to ensure this. Specifically, if variables are stored in Mnesia, the table <span class=\"code\">snmp_variables</span> must be created by the programmer. The record definition for this table is defined in the file <span class=\"code\">snmp/include/snmp_types.hrl</span>. </p> <p>If an instrumentation function in the association file for a variable <span class=\"code\">myVar</span> does not have a name when compiling an MIB, the compiler generates an entry. </p> <div class=\"example\"><pre>{myVar, {snmp_generic, variable_func, [{myVar, Db]}}. </pre></div> <p>And for a table:</p> <div class=\"example\"><pre>{myTable, {snmp_generic, table_func, [{myTable, Db]}}. </pre></div> <p></p>","funcs":" <table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code fun-type\"><span ><span id=\"ghlink-get_status_col-2-id130101\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/lib/snmp/doc/src/snmp_generic.xml#L129\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span><a class=\"title_link\" name=\"get_status_col-2\" href=\"/erldoc/docs/#get_status_col-2\">get_status_col(Name, Cols)</a></span></div></td><td class=\"func-since-td\"></td></tr></tbody></table><table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code fun-type\"><span ><span id=\"ghlink-get_status_col-2-id130107\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/lib/snmp/doc/src/snmp_generic.xml#L129\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span><a class=\"title_link\" name=\"get_status_col-2\" href=\"/erldoc/docs/#get_status_col-2\">get_status_col(NameDb, Cols) -&gt; {ok, StatusVal} | false</a></span></div></td><td class=\"func-since-td\"></td></tr></tbody></table><div class=\"REFBODY rb-5\"><h3 class=\"func-types-title\">Types</h3> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Name = name()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">NameDb = name_db()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Cols = columns()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">StatusVal = term()</span><br></div> </div><div class=\"REFBODY rb-7\"><p> </p><p>Gets the value of the status column from <span class=\"code\">Cols</span>. </p> <p>This function can be used in instrumentation functions for <span class=\"code\">is_set_ok</span>, <span class=\"code\">undo</span> or <span class=\"code\">set</span> to check if the status column of a table is modified.</p> <a name=\"get_index_types\"></a> <p></p></div> <table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code fun-type\"><span ><span id=\"ghlink-get_index_types-1-id130177\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/lib/snmp/doc/src/snmp_generic.xml#L150\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span><a class=\"title_link\" name=\"get_index_types-1\" href=\"/erldoc/docs/#get_index_types-1\">get_index_types(Name)</a></span></div></td><td class=\"func-since-td\"></td></tr></tbody></table><div class=\"REFBODY rb-5\"><h3 class=\"func-types-title\">Types</h3> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Name = name()</span><br></div> </div><div class=\"REFBODY rb-7\"><p> </p><p>Gets the index types of <span class=\"code\">Name</span></p> <p>This function can be used in instrumentation functions to retrieve the index types part of the table info.</p> <a name=\"get_table_info\"></a> <p></p></div> <table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code fun-type\"><span ><span id=\"ghlink-get_table_info-2-id130222\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/lib/snmp/doc/src/snmp_generic.xml#L165\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span><a class=\"title_link\" name=\"get_table_info-2\" href=\"/erldoc/docs/#get_table_info-2\">get_table_info(Name, Item) -&gt; table_info_result()</a></span></div></td><td class=\"func-since-td\"><span class=\"since\">OTP R15B01</span></td></tr></tbody></table><div class=\"REFBODY rb-5\"><h3 class=\"func-types-title\">Types</h3> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Name = name()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Item = table_item() | all</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">table_item() = nbr_of_cols | defvals | status_col | not_accessible | index_types | first_accessible | first_own_index</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">table_info_result() = Value | [{table_item(), Value}]</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Value = term()</span><br></div> </div><div class=\"REFBODY rb-7\"><p> </p><p>Get a specific table info item or, if <span class=\"code\">Item</span> has the value <span class=\"code\">all</span>, a two tuple list (property list) is instead returned with all the items and their respctive values of the given table. </p> <p>This function can be used in instrumentation functions to retrieve a given part of the table info.</p> <a name=\"table_func\"></a> <p></p></div> <table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code fun-type\"><span ><span id=\"ghlink-table_func-2-id130289\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/lib/snmp/doc/src/snmp_generic.xml#L189\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span><a class=\"title_link\" name=\"table_func-2\" href=\"/erldoc/docs/#table_func-2\">table_func(Op1, NameDb)</a></span></div></td><td class=\"func-since-td\"></td></tr></tbody></table><table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code fun-type\"><span ><span id=\"ghlink-table_func-4-id130295\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/lib/snmp/doc/src/snmp_generic.xml#L189\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span><a class=\"title_link\" name=\"table_func-4\" href=\"/erldoc/docs/#table_func-4\">table_func(Op2, RowIndex, Cols, NameDb) -&gt; Ret</a></span></div></td><td class=\"func-since-td\"></td></tr></tbody></table><div class=\"REFBODY rb-5\"><h3 class=\"func-types-title\">Types</h3> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Op1 = new | delete </span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Op2 = get | next | is_set_ok | set | undo</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">NameDb = name_db()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">RowIndex = row_index()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Cols = columns()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Ret = term()</span><br></div> </div><div class=\"REFBODY rb-7\"><p> </p><p>This is the default instrumentation function for tables. </p> <ul> <li>The <span class=\"code\">new</span> function creates the table if it does not exist, but only if the database is the SNMP internal db.</li> <li>The <span class=\"code\">delete</span> function does not delete the table from the database since unloading an MIB does not necessarily mean that the table should be destroyed.</li> <li>The <span class=\"code\">is_set_ok</span> function checks that a row which is to be modified or deleted exists, and that a row which is to be created does not exist.</li> <li>The <span class=\"code\">undo</span> function does nothing.</li> <li>The <span class=\"code\">set</span> function checks if it has enough information to make the row change its status from <span class=\"code\">notReady</span> to <span class=\"code\">notInService</span> (when a row has been been set to <span class=\"code\">createAndWait</span>). If a row is set to <span class=\"code\">createAndWait</span>, columns without a value are set to <span class=\"code\">noinit</span>. If Mnesia is used, the set functionality is handled within a transaction.</li> </ul> <p>If it is possible for a manager to create or delete rows in the table, there must be a <span class=\"code\">RowStatus</span> column for <span class=\"code\">is_set_ok</span>, <span class=\"code\">set</span> and <span class=\"code\">undo</span> to work properly. </p> <p>The function returns according to the specification of an instrumentation function. </p> <a name=\"table_get_elements\"></a> <p></p></div> <table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code fun-type\"><span ><span id=\"ghlink-table_get_elements-3-id130442\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/lib/snmp/doc/src/snmp_generic.xml#L234\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span><a class=\"title_link\" name=\"table_get_elements-3\" href=\"/erldoc/docs/#table_get_elements-3\">table_get_elements(NameDb, RowIndex, Cols) -&gt; Values</a></span></div></td><td class=\"func-since-td\"></td></tr></tbody></table><div class=\"REFBODY rb-5\"><h3 class=\"func-types-title\">Types</h3> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">NameDb = name_db()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">RowIndex = row_index()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Cols = columns()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Values = [value() | noinit]</span><br></div> </div><div class=\"REFBODY rb-7\"><p> </p><p>Returns a list with values for all columns in <span class=\"code\">Cols</span>. If a column is undefined, its value is <span class=\"code\">noinit</span>.</p> <a name=\"table_next\"></a> <p></p></div> <table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code fun-type\"><span ><span id=\"ghlink-table_next-2-id130497\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/lib/snmp/doc/src/snmp_generic.xml#L251\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span><a class=\"title_link\" name=\"table_next-2\" href=\"/erldoc/docs/#table_next-2\">table_next(NameDb, RestOid) -&gt; RowIndex | endOfTable</a></span></div></td><td class=\"func-since-td\"></td></tr></tbody></table><div class=\"REFBODY rb-5\"><h3 class=\"func-types-title\">Types</h3> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">NameDb = name_db()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">RestOid = [int()]</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">RowIndex = row_index()</span><br></div> </div><div class=\"REFBODY rb-7\"><p> </p><p>Finds the indices of the next row in the table. <span class=\"code\">RestOid</span> does not have to specify an existing row.</p> <a name=\"table_row_exists\"></a> <p></p></div> <table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code fun-type\"><span ><span id=\"ghlink-table_row_exists-2-id130545\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/lib/snmp/doc/src/snmp_generic.xml#L267\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span><a class=\"title_link\" name=\"table_row_exists-2\" href=\"/erldoc/docs/#table_row_exists-2\">table_row_exists(NameDb, RowIndex) -&gt; bool()</a></span></div></td><td class=\"func-since-td\"></td></tr></tbody></table><div class=\"REFBODY rb-5\"><h3 class=\"func-types-title\">Types</h3> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">NameDb = name_db()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">RowIndex = row_index()</span><br></div> </div><div class=\"REFBODY rb-7\"><p> </p><p>Checks if a row in a table exists.</p> <a name=\"table_set_elements\"></a> <p></p></div> <table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code fun-type\"><span ><span id=\"ghlink-table_set_elements-3-id130585\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/lib/snmp/doc/src/snmp_generic.xml#L281\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span><a class=\"title_link\" name=\"table_set_elements-3\" href=\"/erldoc/docs/#table_set_elements-3\">table_set_elements(NameDb, RowIndex, Cols) -&gt; bool()</a></span></div></td><td class=\"func-since-td\"></td></tr></tbody></table><div class=\"REFBODY rb-5\"><h3 class=\"func-types-title\">Types</h3> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">NameDb = name_db()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">RowIndex = row_index()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Cols = columns()</span><br></div> </div><div class=\"REFBODY rb-7\"><p> </p><p>Sets the elements in <span class=\"code\">Cols</span> to the row specified by <span class=\"code\">RowIndex</span>. No checks are performed on the new values. </p> <p>If the Mnesia database is used, this function calls <span class=\"code\">mnesia:write</span> to store the values. This means that this function must be called from within a transaction (<span class=\"code\">mnesia:transaction/1</span> or <span class=\"code\">mnesia:dirty/1</span>).</p> <a name=\"variable_func\"></a> <p></p></div> <table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code fun-type\"><span ><span id=\"ghlink-variable_func-2-id130652\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/lib/snmp/doc/src/snmp_generic.xml#L302\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span><a class=\"title_link\" name=\"variable_func-2\" href=\"/erldoc/docs/#variable_func-2\">variable_func(Op1, NameDb)</a></span></div></td><td class=\"func-since-td\"></td></tr></tbody></table><table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code fun-type\"><span ><span id=\"ghlink-variable_func-3-id130658\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/lib/snmp/doc/src/snmp_generic.xml#L302\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span><a class=\"title_link\" name=\"variable_func-3\" href=\"/erldoc/docs/#variable_func-3\">variable_func(Op2, Val, NameDb) -&gt; Ret</a></span></div></td><td class=\"func-since-td\"></td></tr></tbody></table><div class=\"REFBODY rb-5\"><h3 class=\"func-types-title\">Types</h3> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Op1 = new | delete | get</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Op2 = is_set_ok | set | undo</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">NameDb = name_db()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Val = value()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Ret = term()</span><br></div> </div><div class=\"REFBODY rb-7\"><p> </p><p>This is the default instrumentation function for variables.</p> <p>The <span class=\"code\">new</span> function creates a new variable in the database with a default value as defined in the MIB, or a zero value (depending on the type). </p> <p>The <span class=\"code\">delete</span> function does not delete the variable from the database. </p> <p>The function returns according to the specification of an instrumentation function. </p> <a name=\"variable_get\"></a> <p></p></div> <table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code fun-type\"><span ><span id=\"ghlink-variable_get-1-id130731\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/lib/snmp/doc/src/snmp_generic.xml#L327\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span><a class=\"title_link\" name=\"variable_get-1\" href=\"/erldoc/docs/#variable_get-1\">variable_get(NameDb) -&gt; {value, Value} | undefined</a></span></div></td><td class=\"func-since-td\"></td></tr></tbody></table><div class=\"REFBODY rb-5\"><h3 class=\"func-types-title\">Types</h3> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">NameDb = name_db()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">Value = value()</span><br></div> </div><div class=\"REFBODY rb-7\"><p> </p><p>Gets the value of a variable.</p> <a name=\"variable_set\"></a> <p></p></div> <table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code fun-type\"><span ><span id=\"ghlink-variable_set-2-id130771\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/lib/snmp/doc/src/snmp_generic.xml#L341\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span><a class=\"title_link\" name=\"variable_set-2\" href=\"/erldoc/docs/#variable_set-2\">variable_set(NameDb, NewVal) -&gt; true | false</a></span></div></td><td class=\"func-since-td\"></td></tr></tbody></table><div class=\"REFBODY rb-5\"><h3 class=\"func-types-title\">Types</h3> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">NameDb = name_db()</span><br></div> <div class=\"REFTYPES rt-4\"><span class=\"bold_code fun-param-type\">NewVal = value()</span><br></div> </div><div class=\"REFBODY rb-7\"><p> </p><p>Sets a new value to a variable. The variable is created if it does not exist. No checks are made on the type of the new value. </p> <p>Returns <span class=\"code\">false</span> if the <span class=\"code\">NameDb</span> argument is incorrectly specified, otherwise <span class=\"code\">true</span>.</p> <p></p></div> "}