{"summary":"Atomic Functions","description":"<p> </p><p>This module provides a set of functions to do atomic operations towards mutable atomic variables. The implementation utilizes only atomic hardware instructions without any software level locking, which makes it very efficient for concurrent access. The atomics are organized into arrays with the following semantics:</p> <ul> <li> <p>Atomics are 64 bit integers.</p> </li> <li> <p>Atomics can be represented as either signed or unsigned.</p> </li> <li> <p>Atomics wrap around at overflow and underflow operations.</p> </li> <li> <p>All operations guarantee atomicity. No intermediate results can be seen. The result of one mutation can only be the input to one following mutation.</p> </li> <li> <p>All atomic operations are mutually ordered. If atomic B is updated <strong>after</strong> atomic A, then that is how it will appear to any concurrent readers. No one can read the new value of B and then read the old value of A.</p> </li> <li> <p>Indexes into atomic arrays are one-based. An atomic array of arity N contains N atomics with index from 1 to N.</p> </li> </ul> <p></p>","funcs":" <a name=\"new-2\"></a><table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code func-head\" ><span id=\"ghlink-new-2-id330949\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/erts/doc/src/atomics.xml#L72\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span>new(Arity, Opts) -&gt; <span class=\"bold_code bc-17\"><a href=\"/erldoc/docs/#type-atomics_ref\">atomics_ref()</a></span></div></td><td class=\"func-since-td\"><span class=\"since\">OTP 21.2</span></td></tr></tbody></table><div class=\"REFBODY fun-types\"><h3 class=\"func-types-title\">Types</h3><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Arity = integer() &gt;= 1</span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Opts = [Opt]</span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Opt = {signed, boolean()}</span></div></div><div class=\"REFBODY rb-7\"><p> </p><p>Create a new atomic array of <span class=\"code\">Arity</span> atomics.</p> <p>Argument <span class=\"code\">Opts</span> is a list of the following possible options:</p> <dl> <dt><strong><span class=\"code\">{signed, boolean()}</span></strong></dt> <dd><p>Indicate if the elements of the array will be treated as signed or unsigned integers. Default is <span class=\"code\">true</span> (signed).</p> <p>The integer interval for signed atomics are from <span class=\"code\">-(1 bsl 63)</span> to <span class=\"code\">(1 bsl 63)-1</span> and for unsigned atomics from <span class=\"code\">0</span> to <span class=\"code\">(1 bsl 64)-1</span>.</p> </dd> </dl> <p>Atomics are not tied to the current process and are automatically garbage collected when they are no longer referenced.</p> <p></p></div> <a name=\"put-3\"></a><table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code func-head\" ><span id=\"ghlink-put-3-id321225\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/erts/doc/src/atomics.xml#L93\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span>put(Ref, Ix, Value) -&gt; ok</div></td><td class=\"func-since-td\"><span class=\"since\">OTP 21.2</span></td></tr></tbody></table><div class=\"REFBODY fun-types\"><h3 class=\"func-types-title\">Types</h3><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ref = <span class=\"bold_code bc-17\"><a href=\"/erldoc/docs/#type-atomics_ref\">atomics_ref()</a></span></span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ix = Value = integer()</span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\"></span></div></div><div class=\"REFBODY rb-7\"><p> </p><p>Set atomic to <span class=\"code\">Value</span>.</p> <p></p></div> <a name=\"get-2\"></a><table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code func-head\" ><span id=\"ghlink-get-2-id324773\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/erts/doc/src/atomics.xml#L101\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span>get(Ref, Ix) -&gt; integer()</div></td><td class=\"func-since-td\"><span class=\"since\">OTP 21.2</span></td></tr></tbody></table><div class=\"REFBODY fun-types\"><h3 class=\"func-types-title\">Types</h3><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ref = <span class=\"bold_code bc-17\"><a href=\"/erldoc/docs/#type-atomics_ref\">atomics_ref()</a></span></span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ix = integer()</span></div></div><div class=\"REFBODY rb-7\"><p> </p><p>Read atomic value.</p> <p></p></div> <a name=\"add-3\"></a><table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code func-head\" ><span id=\"ghlink-add-3-id324772\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/erts/doc/src/atomics.xml#L109\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span>add(Ref, Ix, Incr) -&gt; ok</div></td><td class=\"func-since-td\"><span class=\"since\">OTP 21.2</span></td></tr></tbody></table><div class=\"REFBODY fun-types\"><h3 class=\"func-types-title\">Types</h3><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ref = <span class=\"bold_code bc-17\"><a href=\"/erldoc/docs/#type-atomics_ref\">atomics_ref()</a></span></span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ix = Incr = integer()</span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\"></span></div></div><div class=\"REFBODY rb-7\"><p> </p><p>Add <span class=\"code\">Incr</span> to atomic.</p> <p></p></div> <a name=\"add_get-3\"></a><table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code func-head\" ><span id=\"ghlink-add_get-3-id322143\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/erts/doc/src/atomics.xml#L117\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span>add_get(Ref, Ix, Incr) -&gt; integer()</div></td><td class=\"func-since-td\"><span class=\"since\">OTP 21.2</span></td></tr></tbody></table><div class=\"REFBODY fun-types\"><h3 class=\"func-types-title\">Types</h3><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ref = <span class=\"bold_code bc-17\"><a href=\"/erldoc/docs/#type-atomics_ref\">atomics_ref()</a></span></span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ix = Incr = integer()</span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\"></span></div></div><div class=\"REFBODY rb-7\"><p> </p><p>Atomic addition and return of the result.</p> <p></p></div> <a name=\"sub-3\"></a><table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code func-head\" ><span id=\"ghlink-sub-3-id322298\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/erts/doc/src/atomics.xml#L125\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span>sub(Ref, Ix, Decr) -&gt; ok</div></td><td class=\"func-since-td\"><span class=\"since\">OTP 21.2</span></td></tr></tbody></table><div class=\"REFBODY fun-types\"><h3 class=\"func-types-title\">Types</h3><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ref = <span class=\"bold_code bc-17\"><a href=\"/erldoc/docs/#type-atomics_ref\">atomics_ref()</a></span></span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ix = Decr = integer()</span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\"></span></div></div><div class=\"REFBODY rb-7\"><p> </p><p>Subtract <span class=\"code\">Decr</span> from atomic.</p> <p></p></div> <a name=\"sub_get-3\"></a><table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code func-head\" ><span id=\"ghlink-sub_get-3-id313175\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/erts/doc/src/atomics.xml#L133\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span>sub_get(Ref, Ix, Decr) -&gt; integer()</div></td><td class=\"func-since-td\"><span class=\"since\">OTP 21.2</span></td></tr></tbody></table><div class=\"REFBODY fun-types\"><h3 class=\"func-types-title\">Types</h3><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ref = <span class=\"bold_code bc-17\"><a href=\"/erldoc/docs/#type-atomics_ref\">atomics_ref()</a></span></span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ix = Decr = integer()</span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\"></span></div></div><div class=\"REFBODY rb-7\"><p> </p><p>Atomic subtraction and return of the result.</p> <p></p></div> <a name=\"exchange-3\"></a><table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code func-head\" ><span id=\"ghlink-exchange-3-id312316\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/erts/doc/src/atomics.xml#L141\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span>exchange(Ref, Ix, Desired) -&gt; integer()</div></td><td class=\"func-since-td\"><span class=\"since\">OTP 21.2</span></td></tr></tbody></table><div class=\"REFBODY fun-types\"><h3 class=\"func-types-title\">Types</h3><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ref = <span class=\"bold_code bc-17\"><a href=\"/erldoc/docs/#type-atomics_ref\">atomics_ref()</a></span></span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ix = Desired = integer()</span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\"></span></div></div><div class=\"REFBODY rb-7\"><p> </p><p>Atomically replaces the value of the atomic with <span class=\"code\">Desired</span> and returns the value it held previously.</p> <p></p></div> <a name=\"compare_exchange-4\"></a><table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code func-head\" ><span id=\"ghlink-compare_exchange-4-id314391\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/erts/doc/src/atomics.xml#L151\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span>compare_exchange(Ref, Ix, Expected, Desired) -&gt; ok | integer()</div></td><td class=\"func-since-td\"><span class=\"since\">OTP 21.2</span></td></tr></tbody></table><div class=\"REFBODY fun-types\"><h3 class=\"func-types-title\">Types</h3><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ref = <span class=\"bold_code bc-17\"><a href=\"/erldoc/docs/#type-atomics_ref\">atomics_ref()</a></span></span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ix = Expected = Desired = integer()</span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\"></span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\"></span></div></div><div class=\"REFBODY rb-7\"><p> </p><p>Atomically compares the atomic with <span class=\"code\">Expected</span>, and if those are equal, set atomic to <span class=\"code\">Desired</span>. Returns <span class=\"code\">ok</span> if <span class=\"code\">Desired</span> was written. Returns the actual atomic value if not equal to <span class=\"code\">Expected</span>.</p> <p></p></div> <a name=\"info-1\"></a><table class=\"func-table\"><tbody><tr class=\"func-tr\"><td class=\"func-td\"><div class=\"bold_code func-head\" ><span id=\"ghlink-info-1-id321720\" class=\"ghlink\"><a href=\"/erldoc/docs/https://github.com/erlang/otp/edit/maint/erts/doc/src/atomics.xml#L162\" title=\"Found an issue with the documentation? Fix it by clicking here!\"><span class=\"pencil\"></span></a></span>info(Ref) -&gt; Info</div></td><td class=\"func-since-td\"><span class=\"since\">OTP 21.2</span></td></tr></tbody></table><div class=\"REFBODY fun-types\"><h3 class=\"func-types-title\">Types</h3><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Ref = <span class=\"bold_code bc-17\"><a href=\"/erldoc/docs/#type-atomics_ref\">atomics_ref()</a></span></span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Info = <br>&#xA0;&#xA0;&#xA0;&#xA0;#{size := Size, max := Max, min := Min, memory := Memory}</span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Size = integer() &gt;= 0</span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Max = Min = integer()</span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\"></span></div><div class=\"REFTYPES rt-1\"><span class=\"bold_code bc-2\">Memory = integer() &gt;= 0</span></div></div><div class=\"REFBODY rb-7\"><p> </p><p>Return information about an atomic array in a map. The map has the following keys:</p> <dl> <dt><strong><span class=\"code\">size</span></strong></dt> <dd><p>The number of atomics in the array.</p></dd> <dt><strong><span class=\"code\">max</span></strong></dt> <dd><p>The highest possible value an atomic in this array can hold.</p></dd> <dt><strong><span class=\"code\">min</span></strong></dt> <dd><p>The lowest possible value an atomic in this array can hold.</p></dd> <dt><strong><span class=\"code\">memory</span></strong></dt> <dd><p>Approximate memory consumption for the array in bytes.</p></dd> </dl> <p></p></div> "}